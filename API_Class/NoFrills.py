from bs4 import BeautifulSoup
import json

html_content = """<div data-testid="product-grid" class="css-epcqr3"><div class="css-0"><div class="css-f5i5wc"><div class="chakra-linkbox css-vhnn8v"><div data-testid="product-image" class="css-16dr4ly"><img alt="null English Cucumber 1 ea, $1.33/1ea" src="https://assets.shop.loblaws.ca/products/20070132001/b3/en/front/20070132001_front_a06_@2.png" srcset="https://assets.shop.loblaws.ca/products/20070132001/b3/en/front/20070132001_front_a06_@2.png 1x, https://assets.shop.loblaws.ca/products/20070132001/b3/en/front/20070132001_front_a06_@2.png 2x" loading="lazy" class="chakra-image css-oguq8l" aria-hidden="true"></div><div class="css-qoklea"><div class="css-12dchmx"></div><div data-testid="price-product-tile" class="css-8atqhb"><p class="chakra-text css-0"><span class="chakra-text css-o93gbd" data-testid="sale-price"><span class="css-idkz9h">$1.33</span>$1.33</span><span class="chakra-text css-623q5h" data-testid="was-price"><span class="css-idkz9h">$1.49</span>$1.49</span></p><p class="chakra-text css-1m5a6y8" data-testid="price-descriptor">SAVE $0.16</p></div><a href="/english-cucumber/p/20070132001_EA?source=nspt" class="chakra-linkbox__overlay css-1hnz6hu"><div class="css-0"><h3 class="chakra-heading css-6qrhwc" id="20070132001_EA" data-testid="product-title">English Cucumber</h3><p class="chakra-text css-1yftjin" data-testid="product-package-size">1 ea, $1.33/1ea</p></div></a><div class="css-8keand"></div></div><div class="css-1q5omjq"><div class="css-fcebb8"><div data-testid="atc-compact" class="css-y94ivq" style="width: 45px;"><button disabled="" type="button" class="chakra-button css-mudsm6" data-testid="atc-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" focusable="false" class="chakra-icon css-1g3sp7a" data-testid="btn-icon" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg><span class="css-idkz9h">Add English Cucumber to cart</span></button></div></div></div></div></div></div><div class="css-0"><div class="css-f5i5wc"><div class="chakra-linkbox css-vhnn8v"><div data-testid="product-image" class="css-16dr4ly"><img alt="null Green Onion 1 bunch, $1.33/1ea" src="https://assets.shop.loblaws.ca/products/20107500001/b3/en/front/20107500001_front_a06_@2.png" srcset="https://assets.shop.loblaws.ca/products/20107500001/b3/en/front/20107500001_front_a06_@2.png 1x, https://assets.shop.loblaws.ca/products/20107500001/b3/en/front/20107500001_front_a06_@2.png 2x" loading="lazy" class="chakra-image css-oguq8l" aria-hidden="true"></div><div class="css-qoklea"><div class="css-12dchmx"></div><div data-testid="price-product-tile" class="css-8atqhb"><p class="chakra-text css-0"><span class="chakra-text css-o93gbd" data-testid="sale-price"><span class="css-idkz9h">$1.33</span>$1.33</span><span class="chakra-text css-623q5h" data-testid="was-price"><span class="css-idkz9h">$1.49</span>$1.49</span></p><p class="chakra-text css-1m5a6y8" data-testid="price-descriptor">SAVE $0.16</p></div><a href="/green-onion/p/20107500001_EA?source=nspt" class="chakra-linkbox__overlay css-1hnz6hu"><div class="css-0"><h3 class="chakra-heading css-6qrhwc" id="20107500001_EA" data-testid="product-title">Green Onion</h3><p class="chakra-text css-1yftjin" data-testid="product-package-size">1 bunch, $1.33/1ea</p></div></a><div class="css-8keand"></div></div><div class="css-1q5omjq"><div class="css-fcebb8"><div data-testid="atc-compact" class="css-y94ivq" style="width: 45px;"><button type="button" class="chakra-button css-mudsm6" data-testid="atc-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" focusable="false" class="chakra-icon css-1g3sp7a" data-testid="btn-icon" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg><span class="css-idkz9h">Add Green Onion to cart</span></button></div></div></div></div></div></div><div class="css-0"><div class="css-f5i5wc"><div class="chakra-linkbox css-vhnn8v"><div data-testid="product-image" class="css-16dr4ly"><img alt="null Asparagus $6.35/1kg $2.88/1lb" src="https://assets.shop.loblaws.ca/products/20174581001/b3/en/front/20174581001_front_a06_@2.png" srcset="https://assets.shop.loblaws.ca/products/20174581001/b3/en/front/20174581001_front_a06_@2.png 1x, https://assets.shop.loblaws.ca/products/20174581001/b3/en/front/20174581001_front_a06_@2.png 2x" loading="lazy" class="chakra-image css-oguq8l" aria-hidden="true"></div><div class="css-qoklea"><div class="css-12dchmx"></div><div data-testid="price-product-tile" class="css-8atqhb"><p class="chakra-text css-0"><span class="chakra-text css-o93gbd" data-testid="sale-price"><span class="css-idkz9h">about $3.75</span>about $3.75</span><span class="chakra-text css-623q5h" data-testid="was-price"><span class="css-idkz9h">$5.19</span>$5.19</span></p><p class="chakra-text css-1m5a6y8" data-testid="price-descriptor">SAVE $1.44</p></div><a href="/asparagus/p/20174581001_KG?source=nspt" class="chakra-linkbox__overlay css-1hnz6hu"><div class="css-0"><h3 class="chakra-heading css-6qrhwc" id="20174581001_KG" data-testid="product-title">Asparagus</h3><p class="chakra-text css-1yftjin" data-testid="product-package-size">$6.35/1kg $2.88/1lb</p></div></a><div class="css-8keand"></div></div><div class="css-1q5omjq"><div class="css-fcebb8"><div data-testid="atc-compact" class="css-y94ivq" style="width: 45px;"><button type="button" class="chakra-button css-mudsm6" data-testid="atc-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" focusable="false" class="chakra-icon css-1g3sp7a" data-testid="btn-icon" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg><span class="css-idkz9h">Add Asparagus to cart</span></button></div></div></div></div></div></div><div class="css-0"><div class="css-f5i5wc"><div class="chakra-linkbox css-vhnn8v"><div data-testid="product-image" class="css-16dr4ly"><img alt="null Tomato Beefsteak  Red $5.49/1kg $2.49/1lb" src="https://assets.shop.loblaws.ca/products/20426141001/b3/en/front/20426141001_front_a06_@2.png" srcset="https://assets.shop.loblaws.ca/products/20426141001/b3/en/front/20426141001_front_a06_@2.png 1x, https://assets.shop.loblaws.ca/products/20426141001/b3/en/front/20426141001_front_a06_@2.png 2x" loading="lazy" class="chakra-image css-oguq8l" aria-hidden="true"></div><div class="css-qoklea"><div class="css-12dchmx"></div><div data-testid="price-product-tile" class="css-8atqhb"><p class="chakra-text css-0"><span class="chakra-text css-pwnbcb" data-testid="regular-price"><span class="css-idkz9h">about $1.47</span>about $1.47</span></p></div><a href="/tomato-beefsteak-red/p/20426141001_KG?source=nspt" class="chakra-linkbox__overlay css-1hnz6hu"><div class="css-0"><h3 class="chakra-heading css-6qrhwc" id="20426141001_KG" data-testid="product-title">Tomato Beefsteak  Red</h3><p class="chakra-text css-1yftjin" data-testid="product-package-size">$5.49/1kg $2.49/1lb</p></div></a><div class="css-8keand"></div></div><div class="css-1q5omjq"><div class="css-fcebb8"><div data-testid="atc-compact" class="css-y94ivq" style="width: 45px;"><button type="button" class="chakra-button css-mudsm6" data-testid="atc-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" focusable="false" class="chakra-icon css-1g3sp7a" data-testid="btn-icon" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg><span class="css-idkz9h">Add Tomato Beefsteak  Red to cart</span></button></div></div></div></div></div></div><div class="css-0"><div class="css-f5i5wc"><div class="chakra-linkbox css-vhnn8v"><div data-testid="product-image" class="css-16dr4ly"><img alt="null Tomato On The Vine Red (1 Bunch) $1.63/1kg $0.74/1lb" src="https://assets.shop.loblaws.ca/products/20026703001/b3/en/front/20026703001_front_a06_@2.png" srcset="https://assets.shop.loblaws.ca/products/20026703001/b3/en/front/20026703001_front_a06_@2.png 1x, https://assets.shop.loblaws.ca/products/20026703001/b3/en/front/20026703001_front_a06_@2.png 2x" loading="lazy" class="chakra-image css-oguq8l" aria-hidden="true"></div><div class="css-qoklea"><div class="css-12dchmx"></div><div data-testid="price-product-tile" class="css-8atqhb"><p class="chakra-text css-0"><span class="chakra-text css-o93gbd" data-testid="sale-price"><span class="css-idkz9h">about $1.16</span>about $1.16</span><span class="chakra-text css-623q5h" data-testid="was-price"><span class="css-idkz9h">$3.89</span>$3.89</span></p><p class="chakra-text css-1m5a6y8" data-testid="price-descriptor">SAVE $2.73</p></div><a href="/tomato-on-the-vine-red-1-bunch/p/20026703001_KG?source=nspt" class="chakra-linkbox__overlay css-1hnz6hu"><div class="css-0"><h3 class="chakra-heading css-6qrhwc" id="20026703001_KG" data-testid="product-title">Tomato On The Vine Red (1 Bunch)</h3><p class="chakra-text css-1yftjin" data-testid="product-package-size">$1.63/1kg $0.74/1lb</p></div></a><div class="css-8keand"></div></div><div class="css-1q5omjq"><div class="css-fcebb8"><div data-testid="atc-compact" class="css-y94ivq" style="width: 45px;"><button type="button" class="chakra-button css-mudsm6" data-testid="atc-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" focusable="false" class="chakra-icon css-1g3sp7a" data-testid="btn-icon" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg><span class="css-idkz9h">Add Tomato On The Vine Red (1 Bunch) to cart</span></button></div></div></div></div></div></div><div class="css-0"><div class="css-f5i5wc"><div class="chakra-linkbox css-vhnn8v"><div data-testid="product-image" class="css-16dr4ly"><img alt="Farmer's Market Yellow Onions, 3 lb Bag 1.36 kg, $0.26/100g" src="https://assets.shop.loblaws.ca/products/20811994001/b3/en/front/20811994001_front_a06_@2.png" srcset="https://assets.shop.loblaws.ca/products/20811994001/b3/en/front/20811994001_front_a06_@2.png 1x, https://assets.shop.loblaws.ca/products/20811994001/b3/en/front/20811994001_front_a06_@2.png 2x" loading="lazy" class="chakra-image css-oguq8l" aria-hidden="true"></div><div class="css-qoklea"><div class="css-12dchmx"></div><div data-testid="price-product-tile" class="css-8atqhb"><p class="chakra-text css-0"><span class="chakra-text css-pwnbcb" data-testid="regular-price"><span class="css-idkz9h">$3.49</span>$3.49</span></p></div><a href="/yellow-onions-3-lb-bag/p/20811994001_EA?source=nspt" class="chakra-linkbox__overlay css-1hnz6hu"><div class="css-0"><p class="chakra-text css-1ecdp9w" data-testid="product-brand">Farmer's Market</p><h3 class="chakra-heading css-6qrhwc" id="20811994001_EA" data-testid="product-title">Yellow Onions, 3 lb Bag</h3><p class="chakra-text css-1yftjin" data-testid="product-package-size">1.36 kg, $0.26/100g</p></div></a><div class="css-8keand"></div></div><div class="css-1q5omjq"><div class="css-fcebb8"><div data-testid="atc-compact" class="css-y94ivq" style="width: 45px;"><button type="button" class="chakra-button css-mudsm6" data-testid="atc-button"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" focusable="false" class="chakra-icon css-1g3sp7a" data-testid="btn-icon" aria-hidden="true" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"></path></svg><span class="css-idkz9h">Add Yellow Onions, 3 lb Bag to cart</span></button></div></div></div></div></div></div></div></div></div>"""

soup = BeautifulSoup(html_content, 'html.parser')

# Extract product information
products = []
product_divs = soup.find_all('div', class_='css-0')
product_id = 1

for product_div in product_divs:
    name_tag = product_div.find('h3', {'data-testid': 'product-title'})
    price_tag = product_div.find('p', {'data-testid': 'product-package-size'})
    
    if name_tag and price_tag:
        name = name_tag.get_text(strip=True)
        price_split = price_tag.get_text(strip=True).split(",")
        price = price_split[1].strip() if len(price_split) > 1 else price_split[0].strip()
        
        products.append({
            'id': product_id,
            'name': name,
            'price': price
        })
        
        product_id += 1

# Write the extracted product details to a JSON file
output_file = r'C:\CP317 Project\CP317-Project\products.json'
with open(output_file, 'w') as json_file:
    json.dump(products, json_file, indent=4)
